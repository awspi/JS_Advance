# 04_JSå‡½æ•°å¼ç¼–ç¨‹

## å®ç°applyã€callã€bind

### call

**æ ¸å¿ƒ:æŠŠåŸå‡½æ•°æŒ‚è½½åˆ°thisArgä¸Š è¿™æ ·fnçš„thiså°±æŒ‡å‘thisArg**

```js
// ç»™æ‰€æœ‰çš„å‡½æ•°æ·»åŠ ä¸€ä¸ªmycallçš„æ–¹æ³• thisArgä¸ŠåŠ ä¸Šè°ƒç”¨çš„å‡½æ•°
Function.prototype.mycall=function(thisArg,...args){ 
  // thisArgä¸ºä¼ å…¥çš„æ–°this
  
  // 1.è·å–éœ€è¦è¢«æ‰§è¡Œçš„å‡½æ•°
  //é»˜è®¤éšå¼ç»‘å®šä¸ºè°ƒç”¨çš„å‡½æ•°
  var fn =this //thisæŒ‡å‘åŸå‡½æ•°

  // 2.å¯¹thisArgè½¬æˆå¯¹è±¡ç±»å‹(é˜²æ­¢å®ƒä¼ å…¥çš„æ˜¯éå¯¹è±¡ç±»å‹)  
  thisArg=(thisArg!==undefined&&thisArg!==null)?Object(thisArg):window//ç”¨Object()è½¬ä¸ºå¯¹è±¡

  // 3.è°ƒç”¨éœ€è¦è¢«æ‰§è¡Œçš„å‡½æ•° //==æ ¸å¿ƒ==
  thisArg.fn=fn//æŒ‚è½½ä¸Šå±æ€§ StringÂ {'abc', fn: Æ’}
  var result = thisArg.fn(...args)
  delete thisArg.fn//ç”¨å®Œé”€æ¯

  return result //è¿”å›åŸå‡½æ•°è¿”å›å€¼
  
}


// TEST
function sum(a,b){
  console.log('sumå‡½æ•°è¢«æ‰§è¡Œ',a+b);
  console.log('sumå‡½æ•°çš„this:'+this);
}
function foo(){
  console.log('foo',this);
}
sum.mycall(foo,1,2)
/* 
3
sumfunction foo(){
  console.log('foo',this);
}
 */
```

### apply 

**applyå’Œcallçš„åŒºåˆ«å°±æ˜¯applyçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°ç»„**

```js
Function.prototype.myapply=function(thisArg,argArray){
  //1.å¤„ç†ç»‘å®šçš„thisArg
  thisArg=(thisArg!==null&&null!==undefined)?Object(thisArg):window
  //2.æ ¸å¿ƒ æŠŠåŸå‡½æ•°æŒ‚è½½åˆ°thisArgä¸Š è¿™æ ·fnçš„thiså°±æŒ‡å‘thisArg
  thisArg.fn = this 
  //3.è°ƒç”¨åŸå‡½æ•°
  argArray=argArray||[] //å¦‚æœä¸ä¼ å…¥argArrayåˆ™è®¾ä¸º[]
  var res = thisArg.fn(...argArray)
  delete thisArg.fn //ç”¨å®ŒæŠŠæŒ‚è½½ä¸Šçš„fnå†åˆ äº†
  return res
}

// TEST
function sum(a,b){
  console.log('sumå‡½æ•°è¢«æ‰§è¡Œ',a+b);
  console.log('sumå‡½æ•°çš„this:'+this);
}
function foo(){
  console.log('foo',this);
}
sum.myapply(foo,[1,2])

function fooo(num) {
  return num
}
fooo.myapply('abc',[1])

function bar() {
  console.log("barå‡½æ•°è¢«æ‰§è¡Œ", this)
}
fooo.myapply('abc')

/* 
sumå‡½æ•°è¢«æ‰§è¡Œ 3
sumå‡½æ•°çš„this:function foo(){
  console.log('foo',this);
}
*/
```



### bind



```js
// ç³»ç»Ÿçš„bindä½¿ç”¨è§„åˆ™
var bar = foo.bind("abc")
bar()

var newSum = sum.bind("aaa", 10, 20, 30, 40) //bindæ—¶å€™ä¼ å…¥_arg
newSum()

var newSum = sum.bind("aaa")
newSum(10, 20, 30, 40)//è°ƒç”¨æ—¶å€™ä¼ å…¥args

var newSum = sum.bind("aaa", 10)///bindæ—¶å€™ä¼ å…¥éƒ¨åˆ†å‚æ•°
newSum(20, 30, 40)//è°ƒç”¨æ—¶å€™ä¼ å…¥å‰©ä¸‹å‚æ•°

```

**bindä¼šè¿”å›ä¸€ä¸ªthisæŒ‡å‘thisArgçš„æ–°å‡½æ•°, å¯ä»¥æ„é€ ä¸€ä¸ªproxyFnè¿”å›**

```js
Function.prototype.mybind = function(thisArg,..._args) {
  // 1.è·å–åˆ°çœŸå®éœ€è¦è°ƒç”¨çš„å‡½æ•°
  var fn=this
  // 2.ç»‘å®šthis
  thisArg=(thisArg!==null&&thisArg!==undefined)?Object(thisArg):window
  
  function proxyFn(...args){
  // 3.å°†å‡½æ•°æ”¾åˆ°thisArgä¸­è¿›è¡Œè°ƒç”¨
    thisArg.fn=fn
    // ç‰¹æ®Š: å¯¹ä¸¤ä¸ªä¼ å…¥çš„å‚æ•°è¿›è¡Œåˆå¹¶
    var finalArgs=[..._args,...args]
    var res = thisArg.fn(...finalArgs)
    delete thisArg.fn
    return res
  }
  // 4.è¿”å›ç»“æœ
  return proxyFn
}

// TEST
function foo() {
  console.log("fooè¢«æ‰§è¡Œ", this)
  return 20
}
var bar = foo.mybind("abc")
var result = bar()
console.log(result)

function sum(num1, num2, num3, num4) {
  console.log(num1, num2, num3, num4)
}
var newSum = sum.mybind("abc", 10, 20)
var result = newSum(30, 40)

```



## arguments

**arguments** æ˜¯ä¸€ä¸ª å¯¹åº”äº **ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°** çš„ **ç±»æ•°ç»„(array-like)å¯¹è±¡**ã€‚

ç±»æ•°ç»„(array-like)å¯¹è±¡ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œè€Œæ˜¯ä¸€ä¸ª**å¯¹è±¡**ç±»å‹:

- æœ‰æ•°ç»„çš„ä¸€äº›ç‰¹æ€§ï¼Œlengthï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡indexç´¢å¼•æ¥è®¿é—®; æ²¡æœ‰æ•°ç»„çš„ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚forEachã€mapç­‰; 
- **`arguments.callee()`**è·å–å½“å‰argumentsæ‰€åœ¨çš„å‡½æ•°

```js
function foo(num1, num2, num3) {
  // ç±»æ•°ç»„å¯¹è±¡ä¸­(é•¿çš„åƒæ˜¯ä¸€ä¸ªæ•°ç»„, æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡): arguments
  // console.log(arguments)
	//[Arguments] { '0': 10, '1': 20, '2': 30, '3': 40, '4': 50 }
  // å¸¸è§çš„å¯¹argumentsçš„æ“ä½œæ˜¯ä¸‰ä¸ª
  // 1.è·å–å‚æ•°çš„é•¿åº¦
  console.log(arguments.length)

  // 2.æ ¹æ®ç´¢å¼•å€¼è·å–æŸä¸€ä¸ªå‚æ•°
  console.log(arguments[2])
  console.log(arguments[3])
  console.log(arguments[4])

  // 3.calleeè·å–å½“å‰argumentsæ‰€åœ¨çš„å‡½æ•°
  console.log(arguments.callee)
  // arguments.callee()
}
foo(10, 20, 30, 40, 50)

```



### arguments->array

```js
var newArr = []
for (var i = 0; i < arguments.length; i++) {
  newArr.push(arguments[i] * 10)
}
console.log(newArr) 
//------
var newArr2 = Array.prototype.slice.call(arguments)
console.log(newArr2)
//------
var newArr3 = [].slice.call(arguments)
console.log(newArr3)
//------
// 2.3.ES6çš„è¯­æ³•
var newArr4 = Array.from(arguments)
console.log(newArr4)
//------
var newArr5 = [...arguments]//å±•å¼€è¿ç®—ç¬¦
console.log(newArr5)
```

>  **Arrayä¸­çš„sliceå®ç°**
>
> ```js
> Array.prototype.myslice = function(start, end) {
>   var arr = this
>   start = start || 0
>   end = end || arr.length
>   var newArray = []
>   for (var i = start; i < end; i++) {
>     newArray.push(arr[i])
>   }
>   return newArray
> }
> ```
>
> 

### ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰arguments

```js
// 1.æ¡ˆä¾‹ä¸€:
//node å…¨å±€æœ‰arguments æµè§ˆå™¨æ²¡æœ‰
var foo = () => {
  console.log(arguments) //arguments is not defined
}

foo()

// 2.æ¡ˆä¾‹äºŒ:
function foo() {
  var bar = () => {
    console.log(arguments)//åœ¨ç®­å¤´å‡½æ•°ä¸­ä½¿ç”¨argumentsä¼šå»ä¸Šå±‚ä½œç”¨åŸŸæŸ¥æ‰¾
  }
  return bar
}
var fn = foo(123)
fn()

// 3.æ¡ˆä¾‹ä¸‰:
var foo = (num1, num2, ...args) => {//...argså‰©ä½™å‚æ•°
  console.log(args)
}

foo(10, 20, 30, 40, 50)

```



## JavaScriptçº¯å‡½æ•°

**å‡½æ•°å¼ç¼–ç¨‹**ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µå«**çº¯å‡½æ•°**ï¼ŒJavaScriptç¬¦åˆ**å‡½æ•°å¼ç¼–ç¨‹çš„èŒƒå¼**ï¼Œæ‰€ä»¥ä¹Ÿ**æœ‰çº¯å‡½æ•°çš„æ¦‚å¿µ**;

- åœ¨**reactå¼€å‘ä¸­çº¯å‡½æ•°æ˜¯è¢«å¤šæ¬¡æåŠ**çš„;
- æ¯”å¦‚**reactä¸­ç»„ä»¶å°±è¢«è¦æ±‚åƒæ˜¯ä¸€ä¸ªçº¯å‡½æ•°**(ä¸ºä»€ä¹ˆæ˜¯åƒï¼Œå› ä¸ºè¿˜æœ‰classç»„ä»¶)ï¼Œ**reduxä¸­æœ‰ä¸€ä¸ªreducerçš„æ¦‚å¿µ**ï¼Œä¹Ÿæ˜¯è¦æ±‚å¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡½æ•°;
- æ‰€ä»¥**æŒæ¡çº¯å‡½æ•°å¯¹äºç†è§£å¾ˆå¤šæ¡†æ¶çš„è®¾è®¡**æ˜¯éå¸¸æœ‰å¸®åŠ©çš„;

**æ ‡å‡†:**

- ç›¸åŒçš„è¾“å…¥ä¸€å®šäº§ç”Ÿç›¸åŒçš„è¾“å‡º
- å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸èƒ½äº§ç”Ÿ**å‰¯ä½œç”¨;**
  - è¡¨ç¤ºåœ¨æ‰§è¡Œä¸€ä¸ªå‡½æ•°æ—¶ï¼Œ**é™¤äº†è¿”å›å‡½æ•°å€¼ä¹‹å¤–**ï¼Œè¿˜**å¯¹è°ƒç”¨å‡½æ•°äº§ç”Ÿäº†é™„åŠ çš„å½±å“**ï¼Œæ¯”å¦‚ä¿®æ”¹äº†å…¨å±€å˜é‡ï¼Œä¿®æ”¹å‚æ•°æˆ–è€…æ”¹å˜å¤–éƒ¨çš„å­˜å‚¨;

### **æ¡ˆä¾‹**

- **slice**:sliceæˆªå–æ•°ç»„æ—¶**ä¸ä¼šå¯¹åŸæ•°ç»„è¿›è¡Œä»»ä½•æ“ä½œ,è€Œæ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°ç»„;** 
- **splice**:spliceæˆªå–æ•°ç»„, **ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„**, ä¹Ÿ**ä¼šå¯¹åŸæ•°ç»„è¿›è¡Œä¿®æ”¹**

**sliceæ˜¯çº¯å‡½æ•°**

```js
var names = ["abc", "cba", "nba", "dna"]

// sliceåªè¦ç»™å®ƒä¼ å…¥ä¸€ä¸ªstart/end, é‚£ä¹ˆå¯¹äºåŒä¸€ä¸ªæ•°ç»„æ¥è¯´, å®ƒä¼šç»™æˆ‘ä»¬è¿”å›ç¡®å®šçš„å€¼
// sliceå‡½æ•°æœ¬èº«å®ƒæ˜¯ä¸ä¼šä¿®æ”¹åŸæ¥çš„æ•°ç»„
// slice -> thisæ‹¿åˆ°names  var arr =this
// sliceå‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°
var newNames1 = names.slice(0, 3)
console.log(newNames1)
console.log(names)
// ["abc", "cba", "nba", "dna"]
// spliceåœ¨æ‰§è¡Œæ—¶, æœ‰ä¿®æ”¹æ‰è°ƒç”¨çš„æ•°ç»„å¯¹è±¡æœ¬èº«, ä¿®æ”¹çš„è¿™ä¸ªæ“ä½œå°±æ˜¯äº§ç”Ÿçš„å‰¯ä½œç”¨
// spliceä¸æ˜¯ä¸€ä¸ªçº¯å‡½æ•°
var newNames2 = names.splice(2)
console.log(newNames2)
console.log(names)
/* 
[ 'abc', 'cba', 'nba' ]
[ 'abc', 'cba', 'nba', 'dna' ]
[ 'nba', 'dna' ]
[ 'abc', 'cba' ]
 */
```

**ç»ƒä¹ **

```js
// fooå‡½æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªçº¯å‡½æ•°?
// 1.ç›¸åŒçš„è¾“å…¥ä¸€å®šäº§ç”Ÿç›¸åŒçš„è¾“å‡º
// 2.åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¸ä¼šäº§ç”Ÿä»»ä½•çš„å‰¯ä½œç”¨
function foo(num1, num2) {
  return num1 * 2 + num2 * num2
}

// barä¸æ˜¯ä¸€ä¸ªçº¯å‡½æ•°, å› ä¸ºå®ƒä¿®æ”¹äº†å¤–ç•Œçš„å˜é‡
var name = "abc" 
function bar() {
  console.log("barå…¶ä»–çš„ä»£ç æ‰§è¡Œ")
  name = "cba"
}

bar()

console.log(name)

// bazä¹Ÿä¸æ˜¯ä¸€ä¸ªçº¯å‡½æ•°, å› ä¸ºæˆ‘ä»¬ä¿®æ”¹äº†ä¼ å…¥çš„å‚æ•°
function baz(info) {
  info.age = 100
}

var obj = {name: "why", age: 18}
baz(obj)
console.log(obj)

// testæ˜¯å¦æ˜¯ä¸€ä¸ªçº¯å‡½æ•°? â€”â€”æ˜¯ä¸€ä¸ªçº¯å‡½æ•° ç›¸åŒçš„è¾“å…¥ä¸€å®šäº§ç”Ÿç›¸åŒçš„è¾“å‡º
function test(info) {
  return {
    ...info,
    age: 100
  }
}

// Reactçš„å‡½æ•°ç»„ä»¶(ç±»ç»„ä»¶)
function HelloWorld(props) { 
  props.info = {}//ä¸å…è®¸
  props.info.name = "why"//ä¸å…è®¸
}

```



### çº¯å‡½æ•°çš„ä¼˜åŠ¿

å¯ä»¥å®‰å¿ƒçš„ç¼–å†™å’Œå®‰å¿ƒçš„ä½¿ç”¨;

- **å†™çš„æ—¶å€™**ä¿è¯äº†å‡½æ•°çš„çº¯åº¦ï¼Œåªæ˜¯å•çº¯å®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å³å¯ï¼Œä¸éœ€è¦å…³å¿ƒä¼ å…¥çš„å†…å®¹æ˜¯å¦‚ä½•è·å¾—çš„æˆ–è€…ä¾èµ–å…¶ä»–çš„å¤–éƒ¨å˜é‡æ˜¯å¦å·²ç»å‘ç”Ÿäº†ä¿®æ”¹;
- **ç”¨çš„æ—¶å€™**ï¼Œä½ ç¡®å®šä½ çš„è¾“å…¥å†…å®¹ä¸ä¼šè¢«ä»»æ„ç¯¡æ”¹ï¼Œå¹¶ä¸”è‡ªå·±ç¡®å®šçš„è¾“å…¥ï¼Œä¸€å®šä¼šæœ‰ç¡®å®šçš„è¾“å‡º;

- Reactä¸­å°±è¦æ±‚æˆ‘ä»¬æ— è®ºæ˜¯**å‡½æ•°è¿˜æ˜¯classå£°æ˜ä¸€ä¸ªç»„ä»¶**ï¼Œè¿™ä¸ªç»„ä»¶éƒ½å¿…é¡»**åƒçº¯å‡½æ•°ä¸€æ ·**ï¼Œ**ä¿æŠ¤å®ƒä»¬çš„propsä¸è¢«ä¿® æ”¹:**

## JavaScriptæŸ¯é‡ŒåŒ–

**æŸ¯é‡ŒåŒ–**ä¹Ÿæ˜¯å±äº**å‡½æ•°å¼ç¼–ç¨‹**é‡Œé¢ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚

æ˜¯æŠŠæ¥æ”¶å¤šä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå˜æˆæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°(æœ€åˆå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°)çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—ä½™ä¸‹çš„å‚æ•°ï¼Œè€Œä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯;

- **åªä¼ é€’ç»™å‡½æ•°ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå‡½æ•°å»å¤„ç†å‰©ä½™çš„å‚æ•°;** 
- è¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¹‹ä¸ºæŸ¯é‡ŒåŒ–;



### æŸ¯é‡ŒåŒ–çš„ç»“æ„

```js
function add(x, y, z) {
  return x + y + z
}

var result = add(10, 20, 30)
console.log(result)

function sum1(x) {
  return function(y) {
    return function(z) {
      return x + y + z
    }
  }
}

var result1 = sum1(10)(20)(30)
console.log(result1)

// ç®­å¤´å‡½æ•°ç®€åŒ–æŸ¯é‡ŒåŒ–çš„ä»£ç 
var sum2 = x => y => z => {
  return x + y + z
}
console.log(sum2(10)(20)(30))

var sum3 = x => y => z => x + y + z
console.log(sum3(10)(20)(30))


```



### è®©å‡½æ•°çš„èŒè´£å•ä¸€

**ä¸ºä»€ä¹ˆéœ€è¦æœ‰æŸ¯é‡ŒåŒ–å‘¢?**

- åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å…¶å®å¾€å¾€å¸Œæœ›**ä¸€ä¸ªå‡½æ•°å¤„ç†çš„é—®é¢˜å°½å¯èƒ½çš„å•ä¸€**ï¼Œè€Œä¸æ˜¯å°†ä¸€å¤§å †çš„å¤„ç†è¿‡ç¨‹äº¤ç»™ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†;
-  é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å°±å¯ä»¥**å°†æ¯æ¬¡ä¼ å…¥çš„å‚æ•°åœ¨å•ä¸€çš„å‡½æ•°ä¸­è¿›è¡Œå¤„ç†**ï¼Œ**å¤„ç†å®Œååœ¨ä¸‹ä¸€ä¸ªå‡½æ•°ä¸­å†ä½¿ç”¨å¤„ç†åçš„ç»“æœ**;

 æ¯”å¦‚ä¸Šé¢çš„æ¡ˆä¾‹æˆ‘ä»¬è¿›è¡Œä¸€ä¸ªä¿®æ”¹:**ä¼ å…¥çš„å‡½æ•°éœ€è¦åˆ†åˆ«è¢«è¿›è¡Œå¦‚ä¸‹å¤„ç†**

```js
function sum1(x) {
  x+=2
  return function(y) {
    y*=2
    return function(z) {
      z*=z
      return x + y + z
    }
  }
}
```



### æŸ¯é‡ŒåŒ–çš„å¤ç”¨

å¦å¤–ä¸€ä¸ªä½¿ç”¨æŸ¯é‡ŒåŒ–çš„åœºæ™¯æ˜¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯ä»¥**å¤ç”¨å‚æ•°é€»è¾‘**:

**example:** 

- makeAdderå‡½æ•°è¦æ±‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªnum(å¹¶ä¸”å¦‚æœæˆ‘ä»¬éœ€è¦çš„è¯ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¯¹numè¿›è¡Œä¸€äº›ä¿®æ”¹);
- åœ¨ä¹‹åä½¿ç”¨è¿”å›çš„å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†ç»§ç»­ä¼ å…¥numäº†;

```js
// å‡å¦‚åœ¨ç¨‹åºä¸­,æˆ‘ä»¬ç»å¸¸éœ€è¦æŠŠ5å’Œå¦å¤–ä¸€ä¸ªæ•°å­—è¿›è¡Œç›¸åŠ 
console.log(sum(5, 10))
console.log(sum(5, 14))
console.log(sum(5, 1100))
console.log(sum(5, 555))
//
function makeAdder(count) {
  count = count * count

  return function(num) {
    return count + num
  }
}

// var result = makeAdder(5)(10)
// console.log(result)
var adder5 = makeAdder(5)
adder5(10)
adder5(14)
adder5(1100)
adder5(555)

```

example2

```js
function log(date, type, message) {
  console.log(`[${date.getHours()}:${date.getMinutes()}][${type}]: [${message}]`)
}

// log(new Date(), "DEBUG", "æŸ¥æ‰¾åˆ°è½®æ’­å›¾çš„bug")
// log(new Date(), "DEBUG", "æŸ¥è¯¢èœå•çš„bug")
// log(new Date(), "DEBUG", "æŸ¥è¯¢æ•°æ®çš„bug")

// æŸ¯é‡ŒåŒ–çš„ä¼˜åŒ–
// function log (date){
//   return function(type){
//     return function(message){
//       console.log(`[${date.getHours()}:${date.getMinutes()}][${type}]: [${message}]`)
//     }
//   }
// }
var log = date => type => message => {
  console.log(`[${date.getHours()}:${date.getMinutes()}][${type}]: [${message}]`)
}

// å¦‚æœæˆ‘ç°åœ¨æ‰“å°çš„éƒ½æ˜¯å½“å‰æ—¶é—´
var nowLog = log(new Date())
nowLog("DEBUG")("æŸ¥æ‰¾åˆ°è½®æ’­å›¾çš„bug")
nowLog("FETURE")("æ–°å¢äº†æ·»åŠ ç”¨æˆ·çš„åŠŸèƒ½")

var nowAndDebugLog = log(new Date())("DEBUG")
nowAndDebugLog("æŸ¥æ‰¾åˆ°è½®æ’­å›¾çš„bug")
nowAndDebugLog("æŸ¥æ‰¾åˆ°è½®æ’­å›¾çš„bug")
nowAndDebugLog("æŸ¥æ‰¾åˆ°è½®æ’­å›¾çš„bug")
nowAndDebugLog("æŸ¥æ‰¾åˆ°è½®æ’­å›¾çš„bug")


var nowAndFetureLog = log(new Date())("FETURE")
nowAndFetureLog("æ·»åŠ æ–°åŠŸèƒ½~")

```



### ğŸ¤”ï¸è‡ªåŠ¨æŸ¯é‡ŒåŒ–å‡½æ•°

å°†å¤šä¸ªæ™®é€šçš„å‡½æ•°ï¼Œè½¬æˆæŸ¯é‡ŒåŒ–å‡½æ•°:

```
// æŸ¯é‡ŒåŒ–å‡½æ•°çš„å®ç°
function currying(fn){
  return function curried(...args){
    //åˆ¤æ–­å½“å‰å·²ç»æ¥æ”¶åˆ°çš„å‚æ•°ä¸ªæ•°å’Œæœ¬èº«éœ€è¦æ¥å—çš„å‚æ•°ä¸ªæ•°æ˜¯å¦ä¸€è‡´
    // 1.å½“å·²ç»ä¼ å…¥çš„å‚æ•° å¤§äºç­‰äº éœ€è¦çš„å‚æ•°æ—¶, å°±æ‰§è¡Œå‡½æ•°
    if(args.length>=fn.length){
      return fn.apply(this,args)
    }else{
      // æ²¡æœ‰è¾¾åˆ°ä¸ªæ•°æ—¶, éœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°, ç»§ç»­æ¥æ¥æ”¶çš„å‚æ•°
      function curried2(..._args){
        // æ¥æ”¶åˆ°å‚æ•°å, éœ€è¦é€’å½’è°ƒç”¨curriedæ¥æ£€æŸ¥å‡½æ•°çš„ä¸ªæ•°æ˜¯å¦è¾¾åˆ°
        return curried.apply(this,[...args,..._args])
      }
      return curried2
    }
  }
}


// TEST


// function foo(x, y, z, m, n, a, b) {
// }
// console.log(foo.length) è·å–å‚æ•°ä¸ªæ•°

function add1(x, y, z) {
  return x + y + z
}

var curryAdd=currying(add1)
console.log(curryAdd(10, 20, 30))
console.log(curryAdd(10, 20)(30))
console.log(curryAdd(10)(20)(30))

```



## ç»„åˆå‡½æ•°

**ç»„åˆ(Compose)å‡½æ•°**æ˜¯åœ¨JavaScriptå¼€å‘è¿‡ç¨‹ä¸­ä¸€ç§å¯¹**å‡½æ•°çš„ä½¿ç”¨æŠ€å·§ã€æ¨¡å¼**:

æ¯”å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦å¯¹æŸä¸€ä¸ªæ•°æ®è¿›è¡Œå‡½æ•°çš„è°ƒç”¨ï¼Œ**æ‰§è¡Œä¸¤ä¸ªå‡½æ•°fn1å’Œfn2ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯ä¾æ¬¡æ‰§è¡Œçš„;** 

- é‚£ä¹ˆå¦‚æœæ¯æ¬¡æˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œä¸¤ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œæ“ä½œä¸Šå°±ä¼šæ˜¾å¾—é‡å¤;
- é‚£ä¹ˆæ˜¯å¦å¯ä»¥å°†è¿™ä¸¤ä¸ªå‡½æ•°ç»„åˆèµ·æ¥ï¼Œè‡ªåŠ¨ä¾æ¬¡è°ƒç”¨å‘¢?
- è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å¯¹å‡½æ•°çš„ç»„åˆï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º **ç»„åˆå‡½æ•°(Compose Function);**

**example**

```js
function double(num) {
  return num * 2
}
function square(num) {
  return num ** 2
}

var count = 10
var result = square(double(count))
console.log(result)

// å®ç°æœ€ç®€å•çš„ç»„åˆå‡½æ•°composeFn
function composeFn(m, n) { // å…ˆdoubleå†square
  return function(count) {
    // m(count)->n(m(count))
    return n(m(count))
  }
}

var newFn = composeFn(double, square)
console.log(newFn(10))

```

### å®ç°é€šç”¨çš„ç»„åˆå‡½æ•°

```js
function mycompose(...fns) {
  // fns.length
  for (var i = 0; i < fns.length; i++) {
    if (typeof fns[i] !== 'function') {
      throw new TypeError('Expected arguments are functions')
    }
  }
  function compose(...args) {
    var index = 0
    var result = fns.length ? fns[index].apply(this, args) : args//fns.length==0,result=args resultå½“ä½œä¸‹æ¬¡è°ƒç”¨çš„å‚æ•°
    while (++index < fns.length) {
      fns[index].call(this, result)
    }
    return result
  }
  return compose
}


// TEST
function double(m) {
  return m * 2
}

function square(n) {
  return n ** 2
}

var newFn = mycompose(double, square)
console.log(newFn(10));
```







# è‡ªåŠ¨æŸ¯é‡ŒåŒ–å’Œé€šç”¨çš„ç»„åˆå‡½æ•°åœ¨JSé«˜çº§ è§†é¢‘07 å¤ä¹ 